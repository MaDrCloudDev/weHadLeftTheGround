<main class="columns" role="region" aria-label="Interactive poem gallery">
  <div
    class="column column1"
    role="button"
    tabindex="0"
    aria-label="Poem section: Are We Ready?"
  >
    <p>Are</p>
    <p>We</p>
    <p>Ready?</p>
  </div>
  <div
    class="column column2"
    role="button"
    tabindex="0"
    aria-label="Poem section: I Had Thought"
  >
    <p>I</p>
    <p>Had</p>
    <p>Thought.</p>
  </div>
  <div
    class="column column3"
    role="button"
    tabindex="0"
    aria-label="Poem section: Flap Left, Right"
  >
    <p>Flap</p>
    <p>Left</p>
    <p>, ...Right.</p>
  </div>
  <div
    class="column column4"
    role="button"
    tabindex="0"
    aria-label="Poem section: Take The Leap"
  >
    <p>Take</p>
    <p>The</p>
    <p>Leap.</p>
  </div>
  <div
    class="column column5"
    role="button"
    tabindex="0"
    aria-label="Poem section: The Ground, a Memory"
  >
    <p>The</p>
    <p>Ground</p>
    <p>, a Memory.</p>
  </div>
</main>
<script>
  const columns: NodeListOf<HTMLElement> = document.querySelectorAll(".column");
  const main: HTMLElement = document.querySelector(".columns")!;

  function closeAllColumns(): void {
    columns.forEach((col: HTMLElement) => {
      col.classList.remove("open", "open-active");
    });
  }

  columns.forEach((column: HTMLElement) => {
    // Click event
    column.addEventListener(
      "click",
      function (this: HTMLElement, e: MouseEvent) {
        e.stopPropagation();
        const isOpen: boolean = this.classList.contains("open");
        closeAllColumns();
        if (!isOpen) {
          this.classList.add("open");
        }
      }
    );

    // Keyboard event for accessibility
    column.addEventListener(
      "keydown",
      function (this: HTMLElement, e: KeyboardEvent) {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          e.stopPropagation();
          const isOpen: boolean = this.classList.contains("open");
          closeAllColumns();
          if (!isOpen) {
            this.classList.add("open");
          }
        }
      }
    );

    // Transition end event
    column.addEventListener(
      "transitionend",
      function (this: HTMLElement, e: TransitionEvent) {
        if (e.propertyName.includes("flex")) {
          this.classList.toggle("open-active", this.classList.contains("open"));
        }
      }
    );
  });

  // Close all columns when clicking outside
  document.addEventListener("click", (e: MouseEvent) => {
    if (!main.contains(e.target as Node)) {
      closeAllColumns();
    }
  });

  // Lazy-load background images
  document.addEventListener("DOMContentLoaded", () => {
    columns.forEach((column: HTMLElement) => {
      const bgImage: string = window.getComputedStyle(column).backgroundImage;
      if (bgImage !== "none") {
        const img: HTMLImageElement = new Image();
        img.src = bgImage.slice(5, -2);
      }
    });
  });
</script>

<style>
  html,
  body,
  div,
  p {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    box-sizing: border-box;
  }

  body {
    font-family:
      "Arial",
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      Oxygen,
      Ubuntu,
      Cantarell,
      "Open Sans",
      "Helvetica Neue",
      sans-serif;
    font-size: 1.2rem;
    font-weight: 500;
    color: white;
    cursor: pointer;
    overflow: hidden;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    min-height: 100vh;
    background: #000;
    line-height: 1.15; /* Improve text rendering */
  }

  .columns {
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
    min-height: 100vh;
    overflow: hidden;
  }

  .column {
    -webkit-box-flex: 3;
    -webkit-flex: 3;
    -ms-flex: 3;
    flex: 3;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -webkit-flex-direction: column;
    -ms-flex-direction: column;
    flex-direction: column;
    background-size: cover;
    background-position: center;
    position: relative;
    box-shadow: inset 0 0 0 0.4rem rgba(255, 255, 255, 0.6);
    -webkit-transition:
      -webkit-box-flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      -webkit-flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      font-size 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      opacity 0.3s ease;
    transition:
      -webkit-box-flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      -moz-box-flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      -ms-flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      flex 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      font-size 0.4s cubic-bezier(0.3, -0.1, 0.3, -0.3),
      opacity 0.3s ease;
    will-change: flex, font-size;
  }

  .column::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: -webkit-linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4));
    background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4));
    z-index: 1;
  }

  .column1 {
    background-image: url(https://cdn.pixabay.com/photo/2017/01/28/02/24/japan-2014618_960_720.jpg);
  }

  .column2 {
    background-image: url(https://cdn.pixabay.com/photo/2020/01/30/21/24/shop-4806610_960_720.jpg);
  }

  .column3 {
    background-image: url(https://cdn.pixabay.com/photo/2020/06/17/17/07/downtown-5310440_960_720.jpg);
  }

  .column4 {
    background-image: url(https://cdn.pixabay.com/photo/2017/01/28/02/24/japan-2014617_960_720.jpg);
  }

  .column5 {
    background-image: url(https://cdn.pixabay.com/photo/2017/01/28/02/24/japan-2014619_960_720.jpg);
  }

  .column p {
    -webkit-box-flex: 1;
    -webkit-flex: 1 0 auto;
    -ms-flex: 1 0 auto;
    flex: 1 0 auto;
    display: -webkit-box;
    display: -webkit-flex;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -webkit-justify-content: center;
    -ms-flex-pack: center;
    justify-content: center;
    -webkit-box-align: center;
    -webkit-align-items: center;
    -ms-flex-align: center;
    align-items: center;
    text-transform: uppercase;
    text-shadow:
      0 0 1em rgba(0, 0, 0, 0.8),
      0 0 2em rgba(0, 0, 0, 0.6);
    font-size: 1.3em;
    -webkit-transition: -webkit-transform 0.3s ease-in-out;
    transition: -webkit-transform 0.3s ease-in-out;
    transition: transform 0.3s ease-in-out;
    transition:
      transform 0.3s ease-in-out,
      -webkit-transform 0.3s ease-in-out;
    position: relative;
    z-index: 2;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  .column p:nth-child(2) {
    font-size: 1.4em;
  }

  .column p:first-child {
    -webkit-transform: translateY(-100%);
    transform: translateY(-100%);
  }

  .column.open-active p:first-child {
    -webkit-transform: translateY(0);
    transform: translateY(0);
  }

  .column p:last-child {
    -webkit-transform: translateY(100%);
    transform: translateY(100%);
  }

  .column.open-active p:last-child {
    -webkit-transform: translateY(0);
    transform: translateY(0);
  }

  .column.open {
    -webkit-box-flex: 5;
    -webkit-flex: 5;
    -ms-flex: 5;
    flex: 5;
    font-size: 1.5em;
  }

  .column:hover:not(.open) {
    opacity: 0.9;
  }

  @media (max-width: 768px) {
    .column p {
      font-size: 1.4em;
    }
    .column.open {
      -webkit-box-flex: 4;
      -webkit-flex: 4;
      -ms-flex: 4;
      flex: 4;
      font-size: 1.3em;
    }
  }

  @media (max-width: 480px) {
    .column p {
      font-size: 1.2em;
    }
    .column.open {
      -webkit-box-flex: 3;
      -webkit-flex: 3;
      -ms-flex: 3;
      flex: 3;
      font-size: 1.1em;
    }
  }
</style>
